<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Backyard Rabbitry Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Ubuntu:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <!-- Application Structure Plan: Major overhaul to a horizontal scrolling SPA. Each tab navigates to a full-viewport section.
        'Legal Lowdown' now includes a provincial selector. 'Fun Quizzes' has category selection and loads 5 random questions. New 'Recipes' section.
        This structure aims for high visual engagement and better content segmentation, reducing apparent vertical scroll within the main view.
    -->
    <!-- Visualization & Content Choices:
        * Layout: Horizontal scroll inspired by FamilyValue.
        * Provincial Compliance: Dropdown in 'Legal Lowdown', dynamic content display.
        * Quizzes: JS-driven categorized quiz engine. Question bank in JS.
        * Recipes: New dedicated section with recipe cards.
        * Styling: Vibrant colors, Poppins/Ubuntu fonts, updated card/button styles.
        CONFIRMATION: NO SVG graphics used. NO Mermaid JS used.
    -->
    <style>
        :root {
            --primary: #8C52FF; /* Vibrant Purple */
            --primary-light: #B28DFF;
            --secondary: #FF914D; /* Bright Orange */
            --accent1: #FF5C8D; /* Lively Pink */
            --accent2: #45C4B0; /* Fresh Teal */
            --dark: #2D3748; /* Charcoal */
            --light: #F7FAFC; /* Off-white */
            --success: #38A169; /* Green */
            --warning: #DD6B20; /* Amber */
            --text-main: #333;
            --text-headings: var(--primary);
            --nav-height: 68px; /* Approximate height of the nav bar */
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--light);
            color: var(--text-main);
            overflow: hidden; /* Prevent body scroll, manage scroll within sections */
            margin: 0;
            padding: 0;
        }

        h1, h2, h3, h4, h5 {
            font-family: 'Ubuntu', sans-serif;
            color: var(--text-headings);
        }
        
        h2 { font-size: 2rem; font-weight: 700; margin-bottom: 1.5rem; padding-bottom: 0.75rem; border-bottom: 3px solid var(--primary-light); }
        h3 { font-size: 1.5rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 1rem; color: var(--secondary); }
        h4 { font-size: 1.25rem; font-weight: 600; margin-top: 1rem; margin-bottom: 0.5rem; color: var(--accent1); }


        .nav-container {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            height: var(--nav-height);
            display: flex;
            align-items: center;
        }

        .tab-button {
            transition: all 0.3s ease;
            border-bottom-width: 4px;
            border-bottom-color: transparent;
            color: var(--dark);
            padding: 0.5rem 0.4rem; /* Adjusted padding for more tabs */
        }
        .tab-button.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            font-weight: 600;
        }
        .tab-button:hover:not(.active) {
            color: var(--primary-light);
            border-bottom-color: var(--primary-light);
        }
        
        .main-scroll-container {
            display: flex;
            width: 1100%; /* 11 sections */
            height: calc(100vh - var(--nav-height)); 
            transition: transform 0.7s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }

        .content-section {
            width: 100vw; /* Each section takes full viewport width */
            height: 100%;
            overflow-y: auto; /* Allow scroll within section if content overflows */
            padding: 1.5rem; /* Reduced padding for more content space */
            /* display: flex; /* Removed to allow natural block flow */
            /* flex-direction: column; */
            /* align-items: center; */ /* Removed to allow natural block flow */
            /* justify-content: flex-start; */ /* Start content from top */
            box-sizing: border-box;
        }
        .content-section::-webkit-scrollbar { width: 8px; }
        .content-section::-webkit-scrollbar-thumb { background-color: var(--primary-light); border-radius: 4px; }
        .content-section::-webkit-scrollbar-track { background-color: var(--light); }


        .chart-container {
            position: relative; width: 100%; max-width: 550px; margin-left: auto; margin-right: auto;
            height: 280px; max-height: 350px; background-color: #FFFFFF; padding: 1rem; border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
        }
        @media (min-width: 768px) { .chart-container { height: 320px; } }

        .card {
            background-color: #FFFFFF; border-radius: 12px;
            box-shadow: 0 8px 16px rgba(45, 55, 72, 0.1);
            padding: 1.25rem; margin-bottom: 1.25rem;
            border-left: 5px solid var(--primary);
        }
        .card-alt { border-left: 5px solid var(--secondary); }

        .input-field, .select-field {
            width: 100%; padding: 0.75rem 1rem; border: 1px solid #CBD5E0; /* Tailwind gray-300 */
            border-radius: 0.375rem; font-size: 0.9rem; background-color: white; color: var(--dark);
        }
        .input-field:focus, .select-field:focus {
            border-color: var(--primary); box-shadow: 0 0 0 0.2rem rgba(140, 82, 255, 0.25); outline: none;
        }
        .label-text { font-weight: 500; margin-bottom: 0.5rem; display: block; color: var(--primary-light); }
        
        .btn {
            padding: 0.75rem 1.5rem; border-radius: 8px; font-weight: 500;
            transition: all 0.3s ease; display: inline-flex; align-items: center; justify-content: center;
            cursor: pointer;
        }
        .btn-primary { background-color: var(--primary); color: white; }
        .btn-primary:hover { background-color: var(--primary-light); transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .btn-secondary { background-color: var(--secondary); color: white; }
        .btn-secondary:hover { background-color: #FFB07D; transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .btn-accent1 { background-color: var(--accent1); color: white; }
        .btn-accent1:hover { background-color: #FF8AAE; transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }


        .expand-button {
            background-color: #E9D8FF; /* Light purple */
            color: var(--primary); padding: 0.6rem 1.2rem; border-radius: 0.375rem;
            font-weight: 500; cursor: pointer; display: inline-flex; align-items: center;
            border: 1px solid var(--primary-light);
        }
        .expand-button i { transition: transform 0.3s ease; margin-left: 0.5rem; }
        .expand-button.open i { transform: rotate(180deg); }
        .expandable-content {
            display: none; margin-top: 1rem; padding: 1.5rem; background-color: #FDFBFF; /* Very light purple/off-white */
            border-radius: 0.5rem; border: 1px solid var(--primary-light);
        }
        
        /* Carousel Styles - adapted for new palette */
        .carousel-container { overflow: hidden; position: relative; width: 100%; max-width: 550px; margin: 1.5rem auto; border-radius: 0.5rem; box-shadow: 0 4px 8px rgba(0,0,0,0.1); background-color: white; }
        .carousel-track { display: flex; transition: transform 0.5s ease-in-out; }
        .carousel-slide { min-width: 100%; box-sizing: border-box; }
        .carousel-slide img { width: 100%; height: 250px; object-fit: cover; display: block; border-radius: 0.5rem 0.5rem 0 0; }
        .carousel-caption { padding: 1rem; background-color: var(--primary); color: white; text-align: center; border-radius: 0 0 0.5rem 0.5rem;}
        .carousel-caption h4 { color: white !important; margin-top: 0 !important; }
        .carousel-button { position: absolute; top: 40%; transform: translateY(-50%); background-color: rgba(140, 82, 255, 0.7); color: white; border: none; padding: 0.5rem 1rem; cursor: pointer; z-index: 10; border-radius: 0.3rem;}
        .carousel-button.prev { left: 10px; }
        .carousel-button.next { right: 10px; }

        /* Quiz Styles - adapted */
        .quiz-category-selector button { margin: 0.5rem; }
        .quiz-option {
            display: block; width: 100%; padding: 0.75rem 1rem; margin-bottom: 0.5rem; text-align: left;
            background-color: #fff; border: 2px solid var(--primary-light); border-radius: 0.375rem; cursor: pointer; transition: all 0.2s ease;
        }
        .quiz-option:hover { background-color: #F0E6FF; } /* Light purple hover */
        .quiz-option.selected { border-color: var(--accent1); background-color: #FFE3EA; } /* Pink selected */
        .quiz-feedback { margin-top: 1rem; padding: 0.75rem; border-radius: 0.375rem; }
        .quiz-feedback.correct { background-color: #D1FAE5; color: #065F46; border: 1px solid #6EE7B7;} /* Green correct */
        .quiz-feedback.incorrect { background-color: #FEE2E2; color: #991B1B; border: 1px solid #FCA5A5;} /* Red incorrect */

        .sim-output-card { background-color: #fff; border: 1px solid var(--primary-light); border-left-width: 5px; padding: 1rem; margin-bottom: 0.75rem; border-radius: 0.375rem; }
        .sim-output-card h5 { font-weight: 600; color: var(--secondary); margin-bottom: 0.25rem; }

        /* Recipe Card Styles */
        .recipe-card {
            background-color: white; border-radius: 12px; box-shadow: 0 6px 12px rgba(0,0,0,0.08);
            overflow: hidden; transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--primary-light);
        }
        .recipe-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.12); }
        .recipe-card img { width: 100%; height: 200px; object-fit: cover; }
        .recipe-card-content { padding: 1rem; }
        .recipe-card-content h4 { color: var(--primary) !important; margin-top: 0 !important; }
        .recipe-card-content ul { list-style: disc; padding-left: 1.5rem; margin-bottom: 0.5rem; font-size: 0.9rem;}
        .recipe-card-content p { font-size: 0.9rem; line-height: 1.6; }

        .province-selector-container { margin-bottom: 1.5rem; }
        .province-details { margin-top: 1rem; padding: 1rem; background-color: #F0E6FF; border-radius: 8px; }

    </style>
</head>
<body>

    <nav class="nav-container">
        <div class="container mx-auto px-1 sm:px-2 lg:px-4">
            <div class="flex justify-center space-x-0 sm:space-x-1 overflow-x-auto py-2">
                <button class="tab-button active text-xs sm:text-sm" onclick="navigateToSection(0)"><i class="fas fa-rocket mr-1"></i>Start</button>
                <button class="tab-button text-xs sm:text-sm" onclick="navigateToSection(1)"><i class="fas fa-balance-scale mr-1"></i>Legal</button>
                <button class="tab-button text-xs sm:text-sm" onclick="navigateToSection(2)"><i class="fas fa-tools mr-1"></i>Setup</button>
                <button class="tab-button text-xs sm:text-sm" onclick="navigateToSection(3)"><i class="fas fa-book-open mr-1"></i>Learn</button>
                <button class="tab-button text-xs sm:text-sm" onclick="navigateToSection(4)"><i class="fas fa-coins mr-1"></i>Budget</button>
                <button class="tab-button text-xs sm:text-sm" onclick="navigateToSection(5)"><i class="fas fa-heartbeat mr-1"></i>Care</button>
                <button class="tab-button text-xs sm:text-sm" onclick="navigateToSection(6)"><i class="fas fa-utensils mr-1"></i>Harvest</button>
                <button class="tab-button text-xs sm:text-sm" onclick="navigateToSection(7)"><i class="fas fa-calendar-alt mr-1"></i>Sim</button>
                <button class="tab-button text-xs sm:text-sm" onclick="navigateToSection(8)"><i class="fas fa-puzzle-piece mr-1"></i>Quiz</button>
                <button class="tab-button text-xs sm:text-sm" onclick="navigateToSection(9)"><i class="fas fa-drumstick-bite mr-1"></i>Recipes</button>
                <button class="tab-button text-xs sm:text-sm" onclick="navigateToSection(10)"><i class="fas fa-link mr-1"></i>Links</button>
            </div>
        </div>
    </nav>
    
    <div id="mainScrollContainer" class="main-scroll-container">
        <section id="gettingStarted" class="content-section">
            <header class="text-center mb-8 py-8" style="background: linear-gradient(135deg, var(--primary) 0%, var(--accent1) 100%); color: white; border-radius: 12px;">
                <h1 class="text-4xl md:text-5xl font-bold mb-4 !text-white"><i class="fas fa-tractor mr-3"></i>Backyard Rabbitry Guide <i class="fas fa-carrot"></i></h1>
                <p class="text-xl text-gray-200">Your family's fun & interactive journey to fresh, home-raised goodness!</p>
            </header>
            <h2><i class="fas fa-seedling mr-2" style="color: var(--success);"></i>Welcome to Your Rabbit Farming Adventure!</h2>
            <p class="mb-6 text-lg text-gray-700">This section helps you understand the wonderful benefits of raising rabbits for your family, why they're a great choice for beginners, and how to get everyone in the family excited and involved. Let's hop to it! 🐇</p>
            <div class="grid md:grid-cols-2 gap-6">
                <div class="card">
                    <h3><i class="fas fa-apple-alt mr-2 text-red-500"></i>The Joy of Raising Your Own Food</h3>
                    <ul class="list-disc list-inside text-gray-700 space-y-2 pl-4">
                        <li>Forge a deeper connection with your family's food source.</li>
                        <li>Ensure quality and origin of meat.</li>
                        <li>Consistent supply of fresh, wholesome protein.</li>
                        <li>Rabbits are quiet and need manageable space.</li>
                        <li>A hands-on learning platform for all ages.</li>
                        <li>Shared tasks and collective satisfaction.</li>
                    </ul>
                </div>
                <div class="card card-alt">
                    <h3><i class="fas fa-graduation-cap mr-2 text-blue-500"></i>Why Rabbits? A Great Choice for Beginners</h3>
                     <ul class="list-disc list-inside text-gray-700 space-y-2 pl-4">
                        <li>Quiet, docile, and relatively odorless.</li>
                        <li>Modest space requirements, low initial setup costs with DIY.</li>
                        <li>Impressive productivity and efficient feed conversion.</li>
                        <li>Daily care can be a shared family responsibility.</li>
                        <li>Low-impact way to produce food at home.</li>
                    </ul>
                </div>
            </div>
             <div class="card mt-6" style="border-left-color: var(--accent2);">
                <h3><i class="fas fa-users mr-2" style="color: var(--accent2);"></i>Getting the Family Onboard</h3>
                <p class="mb-3 text-gray-700">Open communication is key! Clearly explain that rabbits are raised for meat. Involve children in age-appropriate tasks.</p>
                <p class="mt-4 text-gray-700"><strong><i class="fas fa-exclamation-triangle mr-1 text-red-600"></i>Crucial:</strong> Distinguish "meat rabbits" from "pet rabbits" from day one.</p>
            </div>
        </section>

        <section id="legalLocal" class="content-section">
            <h2><i class="fas fa-gavel mr-2 text-gray-600"></i>Legal Lowdown: Rabbit Farming Bylaws</h2>
            <p class="mb-6 text-lg text-gray-700">Understanding local regulations is key. This section will help you navigate compliance for keeping rabbits. Select your province for specific guidance (placeholder information).</p>
            
            <div class="province-selector-container card">
                <label for="provinceSelector" class="label-text !text-xl !text-primary">Select Your Province:</label>
                <select id="provinceSelector" class="select-field text-lg p-3" onchange="showProvinceBylaws()">
                    <option value="">-- Select Province --</option>
                    <option value="GP">Gauteng (Johannesburg Example)</option>
                    <option value="WC">Western Cape</option>
                    <option value="EC">Eastern Cape</option>
                    <option value="KZN">KwaZulu-Natal</option>
                    <option value="LP">Limpopo</option>
                    <option value="MP">Mpumalanga</option>
                    <option value="NW">North West</option>
                    <option value="FS">Free State</option>
                    <option value="NC">Northern Cape</option>
                </select>
            </div>

            <div id="provinceBylawDetails" class="province-details" style="display: none;">
                </div>

            <div id="gautengBylawContent" style="display:none;"> <div class="card">
                    <h3><i class="fas fa-question-circle mr-2 text-orange-500"></i>How many rabbits without a permit? (Gauteng - JHB)</h3>
                    <p class="text-xl font-semibold" style="color: var(--success);">You can keep <strong>five or fewer adult rabbits</strong> without a permit in Johannesburg.</p>
                </div>
                <div class="card card-alt">
                    <h3><i class="fas fa-file-signature mr-2 text-orange-500"></i>Permit for 2 Bucks, 4 Does (Gauteng - JHB)</h3>
                    <p class="text-lg text-gray-700">Since you plan <strong>six adult rabbits</strong>, you <strong>will need a permit</strong> from the City of Johannesburg.</p>
                </div>
                <div class="card">
                     <h3><i class="fas fa-tasks mr-2 text-blue-500"></i>Permit Process (Gauteng - JHB)</h3>
                     <ul class="list-disc list-inside text-gray-700 space-y-1 pl-4">
                        <li>Apply via City of Johannesburg's Environmental Health Department.</li>
                        <li>Process can take time; apply well in advance.</li>
                    </ul>
                </div>
            </div>
             <div id="westernCapeBylawContent" style="display:none;">
                <div class="card">
                    <h3><i class="fas fa-info-circle mr-2 text-blue-500"></i>Rabbit Keeping in Western Cape</h3>
                    <p class="text-gray-700">Bylaws regarding the keeping of rabbits vary by municipality within the Western Cape (e.g., City of Cape Town, Stellenbosch, Drakenstein). It is crucial to contact your specific local municipality's Environmental Health Department or Law Enforcement services to understand the exact rules, permit requirements (if any for small numbers), and regulations for hutch construction, placement, and waste management in your area.</p>
                    <p class="mt-2 font-semibold text-red-600"><i class="fas fa-book-reader mr-1"></i>Action: Contact your local Western Cape municipality.</p>
                </div>
            </div>
             <div id="easternCapeBylawContent" style="display:none;">
                <div class="card">
                    <h3><i class="fas fa-info-circle mr-2 text-blue-500"></i>Rabbit Keeping in Eastern Cape</h3>
                    <p class="text-gray-700">Regulations for keeping rabbits in the Eastern Cape are determined by individual local municipalities (e.g., Buffalo City, Nelson Mandela Bay, etc.). You must consult your local municipality's Environmental Health Department to get precise information on how many rabbits you can keep, whether permits are needed for your intended number, and specific rules for housing and waste.</p>
                     <p class="mt-2 font-semibold text-red-600"><i class="fas fa-book-reader mr-1"></i>Action: Contact your local Eastern Cape municipality.</p>
                </div>
            </div>
            </section>

        <section id="setupBuild" class="content-section">
            <h2><i class="fas fa-hammer mr-2 text-yellow-500"></i>Building Your Rabbitry: Breeds to Hutches</h2>
            <div class="card">
                <h3><i class="fas fa-paw mr-2" style="color:var(--primary-light);"></i>Choosing Your Champions: Best Meat Rabbit Breeds</h3>
                <div class="carousel-container" id="breedCarousel">
                    <div class="carousel-track">
                        <div class="carousel-slide"><img src="https://placehold.co/600x250/B28DFF/FFFFFF?text=New+Zealand+White" alt="New Zealand White"><div class="carousel-caption"><h4>🐑 NZW</h4><p class="text-sm">Rapid growth, calm.</p></div></div>
                        <div class="carousel-slide"><img src="https://placehold.co/600x250/FFB07D/FFFFFF?text=Californian" alt="Californian"><div class="carousel-caption"><h4>🐇 Californian</h4><p class="text-sm">Good meat-to-bone ratio.</p></div></div>
                        <div class="carousel-slide"><img src="https://placehold.co/600x250/FF8AAE/FFFFFF?text=SA+Phendula" alt="SA Phendula"><div class="carousel-caption"><h4>🇿🇦 SA Phendula</h4><p class="text-sm">Locally adapted, hardy.</p></div></div>
                    </div>
                    <button class="carousel-button prev" onclick="moveCarousel('breedCarousel', -1)">&#10094;</button>
                    <button class="carousel-button next" onclick="moveCarousel('breedCarousel', 1)">&#10095;</button>
                </div>
            </div>
             <div class="card card-alt">
                <h3><i class="fas fa-search-location mr-2 text-blue-500"></i>Finding Your Foundation Stock</h3>
                 <ul class="list-disc list-inside text-gray-700 space-y-1 pl-4"><li>Gatabi Rabbits, GRBA, Online. Vet breeders!</li></ul>
            </div>
            <div class="card">
                <h3><i class="fas fa-home mr-2" style="color:var(--accent2);"></i>Your DIY Hutch Project</h3>
                <button class="expand-button btn-accent1 !text-white" onclick="toggleExpandable(this, 'hutchDetails')">Hutch Design Details <i class="fas fa-chevron-down"></i></button>
                <div id="hutchDetails" class="expandable-content"> (Details on design, materials) </div>
            </div>
        </section>

        <section id="learningHub" class="content-section">
            <h2><i class="fas fa-graduation-cap mr-2" style="color:var(--primary);"></i>Learning Hub: Guides, Videos & DIY</h2>
            <div class="card">
                <h3><i class="fas fa-book mr-2" style="color:var(--success);"></i>Rabbit Care Guides</h3>
                 <p class="text-sm text-gray-700">(Placeholder for detailed guides)</p>
            </div>
            <div class="card card-alt">
                <h3><i class="fas fa-video mr-2 text-red-500"></i>Helpful Video Tutorials</h3>
                <p class="text-sm text-gray-700">(Placeholder for video embeds)</p>
            </div>
            <div class="card">
                <h3><i class="fas fa-lightbulb mr-2 text-yellow-500"></i>DIY Project Ideas Carousel</h3>
                 <div class="carousel-container" id="diyCarousel">
                    <div class="carousel-track">
                        <div class="carousel-slide"><img src="https://placehold.co/600x250/B28DFF/FFFFFF?text=DIY+Stacked+Hutch" alt="DIY Stacked Hutch"><div class="carousel-caption"><h4>DIY Stacked Hutch</h4></div></div>
                        <div class="carousel-slide"><img src="https://placehold.co/600x250/FFB07D/FFFFFF?text=DIY+Nipple+Waterer" alt="DIY Nipple Waterer"><div class="carousel-caption"><h4>DIY Nipple Waterer</h4></div></div>
                    </div>
                    <button class="carousel-button prev" onclick="moveCarousel('diyCarousel', -1)">&#10094;</button>
                    <button class="carousel-button next" onclick="moveCarousel('diyCarousel', 1)">&#10095;</button>
                </div>
            </div>
        </section>

        <section id="budgetCosts" class="content-section">
            <h2><i class="fas fa-wallet mr-2" style="color:var(--success);"></i>Budget & Costs: Your Rabbitry Financials</h2>
            <div class="card">
                <h3><i class="fas fa-calculator mr-2 text-orange-500"></i>Initial Investment Calculator</h3>
                (Calculator from previous version, adapted to new styles)
                <div class="grid md:grid-cols-2 gap-x-8 gap-y-6">
                    <div>
                        <h4 class="!text-primary mb-2"><i class="fas fa-venus-mars mr-1"></i>Breeding Stock</h4>
                         <label class="label-text" for="numDoes">Does:</label><input type="number" id="numDoes" value="4" class="input-field" oninput="calculateCosts()">
                         <label class="label-text" for="costPerDoe">Cost/Doe (R):</label><input type="number" id="costPerDoe" value="525" class="input-field" oninput="calculateCosts()">
                         <label class="label-text" for="numBucks">Bucks:</label><input type="number" id="numBucks" value="2" class="input-field" oninput="calculateCosts()">
                         <label class="label-text" for="costPerBuck">Cost/Buck (R):</label><input type="number" id="costPerBuck" value="525" class="input-field" oninput="calculateCosts()">
                        <p class="font-semibold text-lg">Stock: R <span id="stockTotal" class="text-primary">3150.00</span></p>
                    </div>
                     <div>
                        <h4 class="!text-primary mb-2"><i class="fas fa-paint-roller mr-1"></i>DIY Hutch Materials</h4>
                         <label class="label-text" for="timberCost">Timber (R):</label><input type="number" id="timberCost" value="1300" class="input-field" oninput="calculateCosts()">
                        <p class="font-semibold text-lg mt-2">Hutch: R <span id="hutchTotal" class="text-primary">1300.00</span></p>
                    </div>
                </div>
                 <div class="mt-8 p-6 bg-[var(--primary-light)] bg-opacity-20 border-2 border-[var(--primary)] rounded-lg text-center">
                    <h3 class="text-2xl font-bold !text-primary !mt-0">Total Initial: R <span id="grandTotalInvestment">4450.00</span></h3>
                </div>
            </div>
             <div class="card mt-8 card-alt">
                <h3><i class="fas fa-hand-holding-usd mr-2 text-blue-500"></i>Ongoing Expenses (Monthly)</h3>
                (Ongoing cost calculator from previous version, adapted)
                <p class="font-semibold text-lg mt-2">Total Monthly: R <span id="totalMonthlyOngoing" class="text-secondary">639.00</span></p>
            </div>
        </section>

        <section id="careBreeding" class="content-section">
            <h2><i class="fas fa-heart-pulse mr-2 text-red-500"></i>Day-to-Day Rabbit Care and Production</h2>
            (Content from previous version, styled and condensed if needed)
        </section>

        <section id="harvestKitchen" class="content-section">
            <h2><i class="fas fa-drumstick-bite mr-2" style="color:var(--warning);"></i>From Kit to Kitchen: Harvest and Nutrition</h2>
            <div class="grid md:grid-cols-2 gap-6">
                <div class="card card-alt">
                    <h3><i class="fas fa-chart-line mr-2 text-blue-500"></i>Nutritional Value</h3>
                    <div class="chart-container my-4 h-96 sm:h-[450px]"><canvas id="nutritionalComparisonChart"></canvas></div>
                </div>
                <div class="card">
                    <h3><i class="fas fa-dollar-sign mr-2" style="color:var(--success);"></i>Farming Your Own vs. Store</h3>
                    <div class="chart-container my-4 h-80 sm:h-96"><canvas id="costComparisonChart"></canvas></div>
                </div>
            </div>
        </section>

        <section id="timelineSim" class="content-section">
            <h2><i class="fas fa-cogs mr-2" style="color:var(--primary);"></i>Rabbitry Timeline Simulator</h2>
             <div class="card">
                <h3><i class="fas fa-sliders-h mr-2" style="color:var(--success);"></i>Simulation Setup</h3>
                <div class="grid md:grid-cols-3 gap-4 mb-6">
                    <div><label for="simNumDoes" class="label-text"># Does:</label><input type="number" id="simNumDoes" class="input-field" value="4" min="1"></div>
                    <div><label for="simNumBucks" class="label-text"># Bucks:</label><input type="number" id="simNumBucks" class="input-field" value="2" min="1"></div>
                    <div><label for="simStartDate" class="label-text">Start Date:</label><input type="date" id="simStartDate" class="input-field"></div>
                </div>
                <button class="btn btn-primary w-full md:w-auto" onclick="runRabbitrySimulation()"><i class="fas fa-play-circle mr-2"></i>Run Simulation</button>
            </div>
            <div id="simulationOutput" class="mt-8"></div>
        </section>

        <section id="funQuizzes" class="content-section">
            <h2><i class="fas fa-puzzle-piece mr-2" style="color:var(--accent2);"></i>Fun Quizzes: Test Your Rabbit Knowledge!</h2>
            <p class="mb-6 text-lg text-gray-700">Select a category and test your knowledge with 5 random questions!</p>
            <div id="quizCategorySelector" class="quiz-category-selector mb-6 text-center">
                <button class="btn btn-secondary m-1" onclick="startQuiz('Rabbit Basics')">Rabbit Basics</button>
                <button class="btn btn-secondary m-1" onclick="startQuiz('Breeding & Care')">Breeding & Care</button>
                <button class="btn btn-secondary m-1" onclick="startQuiz('Compliance & Legal')">Compliance</button>
                <button class="btn btn-secondary m-1" onclick="startQuiz('Harvest & Recipes')">Harvest & Recipes</button>
            </div>
            <div id="quizArea" class="card" style="display:none;">
                <h3 id="quizCategoryTitle"></h3>
                <div id="quizQuestionContainer"></div>
                <div id="quizNavigation" class="mt-4">
                    <button class="btn btn-accent1" id="nextQuestionBtn" onclick="nextQuizQuestion()">Next Question</button>
                    <button class="btn btn-primary" id="submitQuizBtn" style="display:none;" onclick="submitFullQuiz()">Submit Quiz</button>
                </div>
                <div id="quizResultsArea" class="quiz-feedback mt-4" style="display:none;"></div>
            </div>
        </section>

        <section id="recipes" class="content-section">
            <h2><i class="fas fa-utensils mr-2" style="color:var(--secondary);"></i>🍳 Delicious Rabbit Recipes</h2>
            <p class="mb-6 text-lg text-gray-700">Discover tasty ways to prepare your home-raised rabbit meat. Here are a few ideas to get you started!</p>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="recipe-card">
                    <img src="https://placehold.co/400x200/FF914D/FFFFFF?text=Roasted+Rabbit" alt="Roasted Rabbit">
                    <div class="recipe-card-content">
                        <h4>Simple Roasted Rabbit</h4>
                        <p class="text-sm text-gray-600 mb-2">A classic and easy way to enjoy tender rabbit.</p>
                        <h5>Ingredients:</h5>
                        <ul><li>1 Fryer Rabbit, cut up</li><li>Olive oil</li><li>Salt, Pepper, Herbs (Rosemary, Thyme)</li><li>Garlic cloves</li><li>Optional: Root vegetables</li></ul>
                        <h5>Instructions:</h5>
                        <p class="text-sm">Toss rabbit pieces with oil and seasonings. Arrange in a roasting pan. Roast at 180°C (350°F) for 45-60 mins until cooked through.</p>
                    </div>
                </div>
                <div class="recipe-card">
                    <img src="https://placehold.co/400x200/8C52FF/FFFFFF?text=Rabbit+Stew" alt="Rabbit Stew">
                    <div class="recipe-card-content">
                        <h4>Hearty Rabbit Stew</h4>
                        <p class="text-sm text-gray-600 mb-2">A comforting stew perfect for cooler evenings.</p>
                         <h5>Ingredients:</h5>
                        <ul><li>1 Fryer Rabbit, cut up</li><li>Flour for dredging</li><li>Onions, Carrots, Celery, Potatoes</li><li>Broth (Chicken or Vegetable)</li><li>Bay leaf, Seasonings</li></ul>
                        <h5>Instructions:</h5>
                        <p class="text-sm">Brown floured rabbit pieces. Sauté vegetables. Combine all in a pot with broth, simmer until tender (1.5-2 hours).</p>
                    </div>
                </div>
                 <div class="recipe-card">
                    <img src="https://placehold.co/400x200/45C4B0/FFFFFF?text=Grilled+Rabbit" alt="Grilled Rabbit">
                    <div class="recipe-card-content">
                        <h4>Grilled Lemon-Herb Rabbit</h4>
                        <p class="text-sm text-gray-600 mb-2">A flavorful option for the braai or grill.</p>
                         <h5>Ingredients:</h5>
                        <ul><li>1 Fryer Rabbit, cut up</li><li>Marinade: Olive oil, lemon juice, garlic, fresh herbs (parsley, oregano)</li><li>Salt, Pepper</li></ul>
                        <h5>Instructions:</h5>
                        <p class="text-sm">Marinate rabbit pieces for at least 1 hour. Grill over medium heat until cooked through, turning occasionally.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="resources" class="content-section">
            <h2><i class="fas fa-link mr-2" style="color:var(--accent1);"></i>Resources: Contacts, Records, and More</h2>
             (Content from previous version, styled)
        </section>

         <footer class="text-center py-10 mt-12 border-t-2" style="border-color: var(--primary-light);">
            <p class="text-gray-700 text-lg">&copy; 2025 Family Rabbitry Project. Happy Farming! <i class="fas fa-carrot" style="color:var(--secondary);"></i></p>
            <p class="text-sm text-gray-500 mt-1">Information based on the "A Family Guide to Backyard Rabbit Farming" report.</p>
        </footer>
    </div>

    <script>
        let currentSectionIndex = 0;
        const sections = document.querySelectorAll('.content-section');
        const mainScrollContainer = document.getElementById('mainScrollContainer');
        const navButtons = document.querySelectorAll('.tab-button');

        function navigateToSection(sectionIndex) {
            if (sectionIndex >= 0 && sectionIndex < sections.length) {
                mainScrollContainer.style.transform = `translateX(-${sectionIndex * (100 / sections.length)}%)`;
                currentSectionIndex = sectionIndex;
                navButtons.forEach((btn, index) => {
                    btn.classList.toggle('active', index === sectionIndex);
                });
            }
        }
        
        // Initialize first section
        if (navButtons.length > 0) navButtons[0].classList.add('active');


        let currentSlide = {};
        function setupCarousel(carouselId) {
            currentSlide[carouselId] = 0;
            const track = document.querySelector(`#${carouselId} .carousel-track`);
            if(!track) return;
            const slides = Array.from(track.children);
            if (!slides.length) return;
            const slideWidth = slides[0].getBoundingClientRect().width;
            slides.forEach((slide, index) => slide.style.left = slideWidth * index + 'px');
            showCarouselSlide(carouselId);
        }
        function moveCarousel(carouselId, direction) {
            const track = document.querySelector(`#${carouselId} .carousel-track`);
            if(!track) return;
            const slides = Array.from(track.children);
            if (!slides.length) return;
            const numSlides = slides.length;
            currentSlide[carouselId] = (currentSlide[carouselId] + direction + numSlides) % numSlides;
            showCarouselSlide(carouselId);
        }
        function showCarouselSlide(carouselId) {
            const track = document.querySelector(`#${carouselId} .carousel-track`);
            if (!track) return;
            const slides = Array.from(track.children);
            if (!slides.length) return;
            const slideWidth = slides[0].getBoundingClientRect().width || document.querySelector(`#${carouselId}`).clientWidth;
            track.style.transform = 'translateX(-' + currentSlide[carouselId] * slideWidth + 'px)';
        }

        function toggleExpandable(button, elementId) {
            const content = document.getElementById(elementId);
            const icon = button.querySelector('i');
            if (content.style.display === "block") {
                content.style.display = "none"; button.classList.remove('open');
                icon.classList.replace('fa-chevron-up', 'fa-chevron-down');
            } else {
                content.style.display = "block"; button.classList.add('open');
                icon.classList.replace('fa-chevron-down', 'fa-chevron-up');
            }
        }
        
        function calculateCosts() { /* ... existing function ... */ }
        function calculateOngoingCosts() { /* ... existing function ... */ }
        const nutritionalData = { /* ... existing data ... */ };
        const costData = { /* ... existing data ... */ };
        function createCharts() { /* ... existing function, ensure chartOptions use new palette vars ... */ }
        function runRabbitrySimulation() { /* ... existing function ... */ }

        // --- Provincial Bylaws ---
        const provinceBylawData = {
            "GP": document.getElementById('gautengBylawContent').innerHTML,
            "WC": document.getElementById('westernCapeBylawContent').innerHTML,
            "EC": document.getElementById('easternCapeBylawContent').innerHTML,
            // Add other provinces here once content divs are made
            "KZN": "<div class='card'><h3><i class='fas fa-info-circle mr-2 text-blue-500'></i>Rabbit Keeping in KwaZulu-Natal</h3><p class='text-gray-700'>Contact your local KZN municipality (e.g., eThekwini, Msunduzi) for specific bylaws on rabbit keeping, permits, and housing rules.</p></div>",
            "LP": "<div class='card'><h3><i class='fas fa-info-circle mr-2 text-blue-500'></i>Rabbit Keeping in Limpopo</h3><p class='text-gray-700'>Check with your local Limpopo municipality for regulations regarding backyard rabbit farming.</p></div>",
            "MP": "<div class='card'><h3><i class='fas fa-info-circle mr-2 text-blue-500'></i>Rabbit Keeping in Mpumalanga</h3><p class='text-gray-700'>Consult your local Mpumalanga municipality's Environmental Health dept for rules on keeping rabbits.</p></div>",
            "NW": "<div class='card'><h3><i class='fas fa-info-circle mr-2 text-blue-500'></i>Rabbit Keeping in North West</h3><p class='text-gray-700'>Contact your North West local municipality for specific bylaws.</p></div>",
            "FS": "<div class='card'><h3><i class='fas fa-info-circle mr-2 text-blue-500'></i>Rabbit Keeping in Free State</h3><p class='text-gray-700'>Check with your Free State local municipality for regulations.</p></div>",
            "NC": "<div class='card'><h3><i class='fas fa-info-circle mr-2 text-blue-500'></i>Rabbit Keeping in Northern Cape</h3><p class='text-gray-700'>Consult your Northern Cape local municipality for rules on rabbit keeping.</p></div>",
        };

        function showProvinceBylaws() {
            const selector = document.getElementById('provinceSelector');
            const detailsDiv = document.getElementById('provinceBylawDetails');
            const selectedProvince = selector.value;

            if (selectedProvince && provinceBylawData[selectedProvince]) {
                detailsDiv.innerHTML = provinceBylawData[selectedProvince];
                detailsDiv.style.display = 'block';
            } else {
                detailsDiv.innerHTML = '<p class="text-center text-gray-500">Please select a province to see relevant information (placeholder content). Always verify with your local municipality.</p>';
                detailsDiv.style.display = 'block'; // Show placeholder message
            }
        }
        
        // --- Enhanced Quiz Logic ---
        const quizBank = [
            { category: "Rabbit Basics", question: "What is a baby rabbit called?", options: ["A puppy", "A kit", "A chick", "A bunny"], answer: "A kit" },
            { category: "Rabbit Basics", question: "What is a male rabbit called?", options: ["A buck", "A doe", "A tom", "A boar"], answer: "A buck" },
            { category: "Rabbit Basics", question: "Are rabbits rodents?", options: ["Yes", "No, they are lagomorphs", "Sometimes", "Only wild ones"], answer: "No, they are lagomorphs" },
            { category: "Breeding & Care", question: "What is the average gestation period for a rabbit?", options: ["21 days", "31 days", "45 days", "60 days"], answer: "31 days" },
            { category: "Breeding & Care", question: "What is the term for a female rabbit giving birth?", options: ["Farrowing", "Hatching", "Kindling", "Whelping"], answer: "Kindling" },
            { category: "Breeding & Care", question: "What is a common, highly nutritious feed for rabbits?", options: ["Corn cobs", "Rabbit pellets", "Bread", "Citrus fruits"], answer: "Rabbit pellets" },
            { category: "Compliance & Legal", question: "In Johannesburg, how many adult rabbits can you keep WITHOUT a permit?", options: ["3", "5", "10", "Unlimited"], answer: "5" },
            { category: "Compliance & Legal", question: "Who should you contact for local bylaws on animal keeping?", options: ["The Police", "Your Vet", "Local Municipality Environmental Health", "The SPCA"], answer: "Local Municipality Environmental Health" },
            { category: "Harvest & Recipes", question: "At what age are 'fryer' rabbits typically processed?", options: ["4-6 weeks", "8-12 weeks", "6-9 months", "Over 1 year"], answer: "8-12 weeks" },
            { category: "Harvest & Recipes", question: "Is rabbit meat considered red meat or white meat?", options: ["Red meat", "White meat", "It depends on the breed", "Neither"], answer: "White meat" },
            // Add more questions to reach ~50, covering all categories
        ];

        let currentQuizQuestions = [];
        let currentQuestionIndex = 0;
        let userScore = 0;

        function startQuiz(category) {
            document.getElementById('quizCategorySelector').style.display = 'none';
            document.getElementById('quizArea').style.display = 'block';
            document.getElementById('quizResultsArea').style.display = 'none';
            document.getElementById('quizCategoryTitle').textContent = `${category} Quiz`;

            const categoryQuestions = quizBank.filter(q => q.category === category);
            currentQuizQuestions = categoryQuestions.sort(() => 0.5 - Math.random()).slice(0, 5); // Shuffle and pick 5
            currentQuestionIndex = 0;
            userScore = 0;
            displayQuizQuestion();
        }

        function displayQuizQuestion() {
            if (currentQuestionIndex < currentQuizQuestions.length) {
                const q = currentQuizQuestions[currentQuestionIndex];
                const questionContainer = document.getElementById('quizQuestionContainer');
                let optionsHTML = '';
                q.options.forEach(option => {
                    optionsHTML += `<button class="quiz-option" onclick="selectQuizAnswer(this, '${option}', '${q.answer}')">${option}</button>`;
                });
                questionContainer.innerHTML = `<p class="font-semibold text-lg mb-3">${currentQuestionIndex + 1}. ${q.question}</p><div class="space-y-2">${optionsHTML}</div>`;
                document.getElementById('nextQuestionBtn').style.display = 'inline-flex';
                document.getElementById('submitQuizBtn').style.display = 'none';
            } else {
                showQuizResults();
            }
        }
        
        let selectedAnswerForCurrentQuestion = null;

        function selectQuizAnswer(button, selected, correct) {
            // Remove 'selected' from previously selected option in the same question
            const questionOptions = button.parentElement.querySelectorAll('.quiz-option');
            questionOptions.forEach(opt => opt.classList.remove('selected'));
            // Add 'selected' to the clicked option
            button.classList.add('selected');
            selectedAnswerForCurrentQuestion = selected; // Store the selected answer
        }


        function nextQuizQuestion() {
            if (selectedAnswerForCurrentQuestion === currentQuizQuestions[currentQuestionIndex].answer) {
                userScore++;
            }
            selectedAnswerForCurrentQuestion = null; // Reset for next question
            currentQuestionIndex++;
            if (currentQuestionIndex === currentQuizQuestions.length -1 && currentQuizQuestions.length > 0) { // If it's the last question
                 document.getElementById('nextQuestionBtn').style.display = 'none';
                 document.getElementById('submitQuizBtn').style.display = 'inline-flex';
            }
            if (currentQuestionIndex < currentQuizQuestions.length) {
                 displayQuizQuestion();
            } else {
                 showQuizResults();
            }
        }
        
        function submitFullQuiz() {
             if (selectedAnswerForCurrentQuestion === currentQuizQuestions[currentQuestionIndex].answer) {
                userScore++;
            }
            selectedAnswerForCurrentQuestion = null;
            showQuizResults();
        }


        function showQuizResults() {
            const resultsArea = document.getElementById('quizResultsArea');
            resultsArea.innerHTML = `<p class="font-bold text-xl">Quiz Complete!</p><p>You scored ${userScore} out of ${currentQuizQuestions.length}.</p>`;
            if (userScore === currentQuizQuestions.length) {
                resultsArea.innerHTML += `<p class="mt-2 text-green-600"><i class="fas fa-star"></i> Fantastic! Perfect score!</p>`;
            } else if (userScore >= currentQuizQuestions.length * 0.6) {
                resultsArea.innerHTML += `<p class="mt-2 text-blue-600"><i class="fas fa-thumbs-up"></i> Well done!</p>`;
            } else {
                resultsArea.innerHTML += `<p class="mt-2 text-orange-600">Good effort! Keep learning from the guide!</p>`;
            }
            resultsArea.innerHTML += `<button class="btn btn-primary mt-4" onclick="resetQuiz()">Try Another Category</button>`;
            resultsArea.style.display = 'block';
            document.getElementById('quizQuestionContainer').innerHTML = '';
            document.getElementById('nextQuestionBtn').style.display = 'none';
            document.getElementById('submitQuizBtn').style.display = 'none';
        }

        function resetQuiz() {
            document.getElementById('quizArea').style.display = 'none';
            document.getElementById('quizCategorySelector').style.display = 'block';
        }


        window.onload = () => {
            navigateToSection(0);
            calculateCosts();
            calculateOngoingCosts();
            createCharts();
            setupCarousel('breedCarousel');
            setupCarousel('diyCarousel');
            const today = new Date().toISOString().split('T')[0];
            const simStartDateEl = document.getElementById('simStartDate');
            if(simStartDateEl) simStartDateEl.value = today;
            showProvinceBylaws(); // Initialize with default or selected province
        };
        window.onresize = () => { 
            setupCarousel('breedCarousel');
            setupCarousel('diyCarousel');
        };
    </script>
</body>
</html>
